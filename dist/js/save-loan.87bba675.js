"use strict";(self["webpackChunkprestamos_app"]=self["webpackChunkprestamos_app"]||[]).push([[974],{4691:function(e,t,a){a.r(t),a.d(t,{default:function(){return M}});var s=function(){var e=this,t=e._self._c;return t("div",[t("title-general",{attrs:{title:"",buttonBack:e.backRoute}}),t("div",{staticClass:"o-loan"},[t("p",{staticClass:"o-loan__name"},[e._v(" "+e._s(e.clientName())+" ")]),t("div",{staticClass:"o-loan__card"},[t("input-date",{staticClass:"mb-3",model:{value:e.date,callback:function(t){e.date=t},expression:"date"}}),t("input-general",{staticClass:"mb-3",attrs:{max:11,label:"Capital","is-number":"",icon:"fa-money-bill-wave"},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}}),t("input-general",{staticClass:"mb-3",attrs:{max:11,label:"Interés","is-number":"",icon:"fa-hand-holding-dollar"},model:{value:e.interes,callback:function(t){e.interes=t},expression:"interes"}}),t("div",{staticClass:"d-flex align-items-center justify-content-between"},[t("input-general",{staticClass:"mb-0",attrs:{label:"Cuotas",max:3,"is-document":"",icon:"fa-repeat"},model:{value:e.fees,callback:function(t){e.fees=t},expression:"fees"}}),t("input-select",{staticClass:"mb-0",attrs:{options:e.typesTimes},model:{value:e.typeTime,callback:function(t){e.typeTime=t},expression:"typeTime"}})],1)],1),t("div",{staticClass:"o-loan__body"},[e.isValidData?t("div",[t("p",{staticClass:"o-loan__title"},[e._v("Valor de la cuota")]),t("p",{staticClass:"mb-4"},[e._v("$ "+e._s(e.feeValue))]),t("p",{staticClass:"o-loan__title"},[e._v("Fechas de las cuotas")]),t("div",{staticClass:"o-loan__dates"},[t("ul",e._l(e.paymentDates,(function(a,s){return t("li",{key:s},[e._v(e._s(a))])})),0)])]):e._e(),t("div",{staticClass:"l-button"},[t("button",{staticClass:"button-general",on:{click:function(t){return e.save()}}},[e._v("GUARDAR PRÉSTAMO")])])])])],1)},l=[],n=a(3923),i=a(3822),o=a(8866),c=a(3972),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"input-container"},[e.icon?t("f-icon",{staticClass:"input-icon",attrs:{icon:e.icon}}):e._e(),t("b-form-select",{staticClass:"input-general",attrs:{options:e.options},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),t("valid-alert",{attrs:{"data-value":e.selected,validate:e.validate}})],1)},u=[],d=a(1939),h=a(7849),p={name:"InputSelect",components:{validAlert:d.Z},props:{label:{type:[String],default:""},value:{type:[String,Number,Date],default:""},icon:{type:String,default:""},options:{type:Array},validate:{type:Boolean,default:!1}},data(){return{selected:this.value,es:h.es}},watch:{selected(){this.$emit("input",this.selected)},value(e){this.selected=e}}},m=p,f=a(1001),v=(0,f.Z)(m,r,u,!1,null,null,null),y=v.exports,C=a(6797),b=a.n(C),Z=a(3404);function S(e,t){let a=[],s=b()(e);for(let l=1;l<=t;l++){const e=b()(s).add(1,"d");a.push(e.format("DD-MM-YYYY")),s=b()(e)}return a}function _(e,t){let a=[],s=b()(e);for(let l=1;l<=t;l++){const e=b()(s).add(7,"d");a.push(e.format("DD-MM-YYYY")),s=b()(e)}return a}function g(e,t){let a=b()(e),s=a.date();const l=a.month()+1,n=a.year();let i=[];s>30&&(s=30);let o=s+15;o>30&&(o-=30);let c=s,r=l,u=n;const d=s+15;for(let h=1;h<=t;h++){h%2!==0?d>30&&(r+=1):d<=30&&(r+=1),r>12&&(r=1,u+=1);let e="";h%2===0?(e=`${Z.P.pad(r)}/${Z.P.pad(c)}/${u}`,2===r&&c>28&&(e=`02/28/${u}`)):(e=`${Z.P.pad(r)}/${Z.P.pad(o)}/${u}`,2===r&&o>28&&(e=`02/28/${u}`)),i.push(b()(e).format("DD-MM-YYYY"))}return i}function D(e,t){let a=b()(e),s=a.date(),l=a.month()+1,n=a.year(),i=[];s>30&&(s=30);for(let o=1;o<=t;o++){l+=1,l>12&&(l=1,n+=1);let e=l+"/"+s+"/"+n;2===l&&s>28&&(e=l+"/"+s+"/"+n),i.push(b()(e).format("DD-MM-YYYY"))}return i}function L(e,t,a){return 1===a?S(e,t,a):8===a?_(e,t,a):15===a?g(e,t,a):30===a?D(e,t,a):void 0}const w={calculate:L};var T=a(7695),k=a(2399),I=a(9772),B={components:{TitleGeneral:n.Z,InputDate:o.Z,InputGeneral:c.Z,InputSelect:y},data(){return{id:"",date:"",amount:"",interes:"",fees:"",typeTime:"",balance:0,paymentDates:[],validate:!1,uc:new T.Z,clientsUc:new I.Z}},watch:{date(){this.calculate()},amount(){this.calculate()},interes(){this.calculate()},fees(){this.calculate()},typeTime(){this.calculate()}},computed:{typesTimes(){return[{value:"",text:"Plazo"},{value:1,text:"Diario"},{value:8,text:"Semanal"},{value:15,text:"Quincenal"},{value:30,text:"Mensual"}]},isValidData(){return this.date&&this.amount&&this.interes&&this.typeTime&&this.fees},isValidDataFees(){return this.date&&this.amount&&this.interes},feeValue(){const e=this.amount.replaceAll(".",""),t=this.interes.replaceAll(".","");return Z.P.onlyNumber(parseInt((parseInt(e)+parseInt(t))/parseInt(this.fees)))},...(0,i.rn)("loansStore",["loanSelected","backRoute"]),...(0,i.rn)("clientsStore",["clientSelected"])},methods:{setCurrentDate(){this.date=new Date},calculate(){this.paymentDates=w.calculate(this.date,this.fees,this.typeTime)},async save(){if(this.validate=!0,this.isValidDataFees){const e=this.uc.saveLoan(this.clientId(),this.date,this.amount,this.interes,this.typeTime,this.fees,!1,this.balance,this.id,this.paymentDates,this.feeValue);await k.t.notify("Préstamo guardado correctamente"),this.setLoanSelected(e.loan),this.$router.push("/detail-loan")}},fillData(){this.loanSelected&&(this.id=this.loanSelected.id,this.date=new Date(this.loanSelected.date),this.amount=Z.P.formatNumber(this.loanSelected.amount),this.interes=Z.P.formatNumber(this.loanSelected.interes),this.fees=this.loanSelected.feesNum,this.fees=this.loanSelected.feesNum,this.balance=this.loanSelected.balance,this.typeTime=this.loanSelected.typeTime,this.calculate())},clientName(){if(this.loanSelected){const e=this.clientsUc.getClientById(this.loanSelected.clientId);return e.name}return this.clientSelected?this.clientSelected.name:""},clientId(){if(this.loanSelected){const e=this.clientsUc.getClientById(this.loanSelected.clientId);return e.id}return this.clientSelected?this.clientSelected.id:""},...(0,i.OI)("loansStore",["setLoanSelected","setBackRoute"])},created(){this.setCurrentDate(),this.fillData()}},x=B,Y=(0,f.Z)(x,s,l,!1,null,null,null),M=Y.exports},9772:function(e,t,a){a.d(t,{Z:function(){return u}});var s=a(714),l=a(8829),n=a(2575),i=a(889),o=a(4527),c=new WeakMap,r=new WeakMap;class u{constructor(){(0,s.Z)(this,c,{writable:!0,value:void 0}),(0,s.Z)(this,r,{writable:!0,value:void 0}),(0,n.Z)(this,c,new i.Z),(0,n.Z)(this,r,new o.Z)}getClientByDocument(e){return(0,l.Z)(this,c).getClientByDoc(e)}getClientById(e){return(0,l.Z)(this,c).getClientById(e)}getAllClients(){return(0,l.Z)(this,c).getClientsFromLocal()}getClientsByFilter(e){return(0,l.Z)(this,c).getClientsFromLocalBySearch(e)}saveClient(e,t,a,s,n,i,o,r){let u=[];return u=r?(0,l.Z)(this,c).updateClientToLocal(r,e,t,a,s,n,i,o):(0,l.Z)(this,c).addClientToLocal(e,t,a,s,n,i,o),u}deleteClient(e){return(0,l.Z)(this,r).deleteByClient(e),(0,l.Z)(this,c).deleteToLocal(e)}}},7695:function(e,t,a){a.d(t,{Z:function(){return u}});var s=a(714),l=a(8829),n=a(2575),i=a(9844),o=a(4527),c=new WeakMap,r=new WeakMap;class u{constructor(){(0,s.Z)(this,c,{writable:!0,value:void 0}),(0,s.Z)(this,r,{writable:!0,value:void 0}),(0,n.Z)(this,c,new o.Z),(0,n.Z)(this,r,new i.Z)}getLoansByClient(e){return(0,l.Z)(this,c).getLoansByClient(e)}getLoanById(e){return(0,l.Z)(this,c).getLoanById(e)}getAllLoans(e,t){return(0,l.Z)(this,c).getLoansFromLocal(e,t)}saveLoan(e,t,a,s,n,i,o,u,d,h,p){let m={};return d?(m=(0,l.Z)(this,c).updateLoanToLocal(d,e,t,a,s,n,i,o,u),(0,l.Z)(this,r).deleteByLoan(d)):m=(0,l.Z)(this,c).addLoanToLocal(e,t,a,s,n,i),i&&n&&(0,l.Z)(this,r).addFeesToLocal(m.loan.id,h,p),m}deleteLoan(e){return(0,l.Z)(this,c).deleteToLocal(e)}deleteByClient(e){return(0,l.Z)(this,c).deleteByClient(e)}closeLoan(e){return(0,l.Z)(this,c).closeLoan(e)}}}}]);
//# sourceMappingURL=save-loan.87bba675.js.map